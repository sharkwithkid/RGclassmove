## 학생명부는 항상 “작업일 기준 BM 서버 상태 1개”

작년/올해 명부 두 개 쓰지 않는다.

파일명에 YYYY학년도 안 붙여도 된다. 있으면 “안내용”으로만.

## pre/post 판정은 작업일(work_date) vs 개학일(open_date) 비교로만

work_date < open_date → PRE

퇴원일자 = 개학일 (서버 상태 바뀌는 날)

work_date ≥ open_date → POST

퇴원일자 = 작업일

## 전출(퇴원) 처리에서 졸업 학년 로직

POST인데, 전출 명단 학년이 “작년 마지막 학년(졸업 학년)”이고,
현재 명부에서 이름/학년 매칭 안 되면:

자동 제외로 처리

다만 지금 단계에선 “퇴원_보류 시트에 넣되, 보류사유에 자동 제외 사유를 명시”

PRE일 때 마지막 학년은 어차피 곧 졸업으로 날아갈 애들이라
→ 전출 안 올려도 되지만, 일단은 동일하게 “자동 제외”로 표기해서 보류 시트에만 남겨두고, 실제 BM 업로드 대상(퇴원 시트)에는 올리지 않는다.

## 통계/요약 박스

퇴원 결과는 세 가지 숫자로 보여준다:

정상 처리 수

보류(사람이 봐야 하는 것)

자동 제외(명부 없음/졸업 학년 때문에 프로그램이 뺀 것)